<script>
  (function () {
    // 1) Проверяем, открыто ли внутри Telegram
    const tg = (window.Telegram && window.Telegram.WebApp) ? window.Telegram.WebApp : null;
    if (tg) tg.ready();

    // 2) Клик по кнопке
    const btn = document.getElementById('submit');
    btn.setAttribute('type', 'button'); // на всякий случай
    btn.addEventListener('click', () => {
      if (!tg) {
        alert('Откройте эту страницу через Telegram (кнопка мини-приложения).');
        return;
      }
      const selected = document.querySelector('input[name="color"]:checked');
      const val = selected ? selected.value : 'white';

      // Визуальный фидбек в приложении
      try { tg.HapticFeedback && tg.HapticFeedback.impactOccurred('medium'); } catch (_) {}

      // Отправляем данные боту
      tg.sendData(JSON.stringify({ color: val }));

      // Не обязательно, но полезно чтобы окно закрылось
      // и пользователь вернулся в чат
      try { tg.close(); } catch (_) {}

      // На случай старых клиентов, покажем тост
      try { tg.showPopup({ title: 'Отправлено', message: 'Выбор передан боту.' }); } catch (_) {}
    });
  })();
</script>
